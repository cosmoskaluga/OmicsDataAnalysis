[["index.html", "Omics Data Analysis Chapter 1 Introduction 1.1 How to deal with R 1.2 Assignment and grading", " Omics Data Analysis Dmitrii Smirnov 2024-02-07 Chapter 1 Introduction This bookdown will consist of three seminars for the following lectures delivering at “Omics Data Analysis” course at Skolkovo Institute of Science and Technology: Lecture 4: Differential Expression Analysis Lecture 9: Transcriptome Assembly Lecture 13: Lipidomics Data Analysis 1.1 How to deal with R Use the instruction: https://docs.google.com/document/d/1vyR7T7nHnWgRfQPntLU3U2jaZFJia8zH/edit?usp=sharing&amp;ouid=118110925940360211775&amp;rtpof=true&amp;sd=true 1.2 Assignment and grading When you complete all the tasks please upload to Canvas: Report with plots, pictures, answers and explanations. Your code (txt/pdf/R markdown or something else readable) How it will be graded: * The maximum is 7 points. For missing step - minus 5 points. If the report/code is missing - 0 points. For each missing figure/plot - minus 2 points. For each missing answer to ❓ - minus 2 points. For any other mistake - minus 0.2 point. "],["input-dataset.html", "Chapter 2 Input dataset 2.1 Count importing 2.2 DESeq2 object", " Chapter 2 Input dataset Today we will focus on the differential gene expression analysis to study the molecular signatures of Amyloid-β toxicity in yeast using the data obtained from GEO database (https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE128905). There are 2 experimental groups of replicates: Control and Aβ42 (yeasts expressing Aβ42 peptide) with 3 replicates per group. Raw reads were already preprocessed and Salmon pseudocounts are accessible here: /home/d.smirnov/homework4/SalmonOutput 2.1 Count importing Import libraries: library(dplyr) library(ggplot2) library(DESeq2) library(DOSE) library(pheatmap) library(tibble) library(clusterProfiler) data &lt;- read.csv(&quot;../../Data.csv&quot;, row.names = 1) We need a file which maps our samples to the corresponding sample groups that we are investigating. We will use the columns headers from the counts matrix as the row names of our metadata file and have single column to identify each sample. meta &lt;- colnames(data) %&gt;% .[-c(1)] %&gt;% strsplit(split = &#39;_&#39;) %&gt;% as.data.frame() %&gt;% t() rownames(meta) &lt;- colnames(data)[-c(1)] colnames(meta) &lt;- c(&quot;Genotype&quot;, &quot;Treatment&quot;, &quot;SampleID&quot;) meta &lt;- as.data.frame(meta) data &lt;- data[rowSums(data[,-c(1)]) &gt; 10, ] 2.2 DESeq2 object Let’s start by creating the DESeqDataSet object. To create the object we will need the count matrix and the metadata table as input. We will also need to specify a design formula. The design formula specifies the column(s) in the metadata table and how they should be used in the analysis. For our dataset we only have one column we are interested in, that is \\(~genotype\\). This column has two factor levels, which tells DESeq2 that for each gene we want to evaluate gene expression change with respect to two different levels. Create DESeq2Dataset object: dds &lt;- DESeqDataSetFromMatrix(countData = round(data[,-c(1)]), colData = meta, design = ~ Genotype + Treatment) ## converting counts to integer mode ## Warning in DESeqDataSet(se, design = design, ignoreRank): some variables in design formula are characters, converting to factors dds ## class: DESeqDataSet ## dim: 22783 12 ## metadata(1): version ## assays(1): counts ## rownames(22783): ENSMUSG00000051951 ENSMUSG00000103377 ... ENSMUSG00000063897 ENSMUSG00000095742 ## rowData names(0): ## colnames(12): KO_PBS_642 KO_PBS_641 ... Control_LPS_184 Control_LPS_149 ## colData names(3): Genotype Treatment SampleID "],["cross.html", "Chapter 3 Quality control 3.1 Normalization 3.2 Principal Component Analysis (PCA) 3.3 Correlation Heatmap (PCA)", " Chapter 3 Quality control 3.1 Normalization dds &lt;- estimateSizeFactors(dds) rld &lt;- rlog(dds, blind = TRUE) 3.2 Principal Component Analysis (PCA) plotPCA.mystyle &lt;- function (object, ntop = 2400, returnData = FALSE) { font.size &lt;- 18 rv &lt;- rowVars(assay(object)) r &lt;- assay(object) select &lt;- order(rv, decreasing = TRUE)[seq_len(min(ntop, length(rv)))] pca &lt;- prcomp(t(assay(object)[select, ])) percentVar &lt;- pca$sdev^2/sum(pca$sdev^2) d1 &lt;- data.frame(PC1 = pca$x[, 1], PC2 = pca$x[, 2], Genotype = meta$Genotype, Treatment = meta$Treatment, name = colnames(object)) if (returnData) { attr(d, &quot;percentVar&quot;) &lt;- percentVar[1:2] return(d) } ggplot(data = d1, aes_string(x = &quot;PC1&quot;, y = &quot;PC2&quot;)) + geom_point(aes_string(color = &quot;Genotype&quot;, shape = &quot;Treatment&quot;), size = 6) + xlab(paste0(&quot;PC1: &quot;, round(percentVar[1] * 100), &quot;% variance&quot;)) + ylab(paste0(&quot;PC2: &quot;, round(percentVar[2] * 100), &quot;% variance&quot;)) + theme_dose(font.size = font.size)+ #+ geom_label_repel(aes(label = colnames(data)), label.size = 0.1, box.padding = 0.2) theme( legend.key = element_rect(colour = NA, fill = NA), legend.title= element_blank(), legend.text=element_text(size=font.size-2) ) } plotPCA.mystyle(rld) 3.3 Correlation Heatmap (PCA) rld_mat &lt;- assay(rld) rld_cor &lt;- cor(rld_mat) pheatmap(rld_cor, annotation = meta[,c(1,2)]) "],["differential-testing.html", "Chapter 4 Differential testing", " Chapter 4 Differential testing All the steps of differential expression analysis can be done with a single call of the function DESeq(). meta$Factors &lt;- paste(meta$Genotype, meta$Treatment, sep = &#39;_&#39;) dds_factors &lt;- DESeqDataSetFromMatrix(countData = round(data[,-c(1)]), colData = meta, design = ~ Factors) ## converting counts to integer mode ## Warning in DESeqDataSet(se, design = design, ignoreRank): some variables in design formula are characters, converting to factors dds_analysis &lt;- DESeq(dds_factors) ## estimating size factors ## estimating dispersions ## gene-wise dispersion estimates ## mean-dispersion relationship ## final dispersion estimates ## fitting model and testing plotDispEsts(dds_analysis) contrast_pbs &lt;- c(&quot;Factors&quot;, &quot;KO_PBS&quot;, &quot;Control_PBS&quot;) contrast_lps &lt;- c(&quot;Factors&quot;, &quot;KO_LPS&quot;, &quot;Control_LPS&quot;) res_unshrunken_pbs &lt;- results(dds_analysis, contrast=contrast_pbs, alpha = 0.05) res_unshrunken_lps &lt;- results(dds_analysis, contrast=contrast_lps, alpha = 0.05) res_pbs &lt;- lfcShrink(dds_analysis, contrast=contrast_pbs, res=res_unshrunken_pbs, type=&#39;normal&#39;) ## using &#39;normal&#39; for LFC shrinkage, the Normal prior from Love et al (2014). ## ## Note that type=&#39;apeglm&#39; and type=&#39;ashr&#39; have shown to have less bias than type=&#39;normal&#39;. ## See ?lfcShrink for more details on shrinkage type, and the DESeq2 vignette. ## Reference: https://doi.org/10.1093/bioinformatics/bty895 res_lps &lt;- lfcShrink(dds_analysis, contrast=contrast_lps, res=res_unshrunken_lps, type=&#39;normal&#39;) ## using &#39;normal&#39; for LFC shrinkage, the Normal prior from Love et al (2014). ## ## Note that type=&#39;apeglm&#39; and type=&#39;ashr&#39; have shown to have less bias than type=&#39;normal&#39;. ## See ?lfcShrink for more details on shrinkage type, and the DESeq2 vignette. ## Reference: https://doi.org/10.1093/bioinformatics/bty895 plotMA(res_pbs, ylim=c(-3,5)) summary(res_pbs, alpha = 0.05) ## ## out of 22783 with nonzero total read count ## adjusted p-value &lt; 0.05 ## LFC &gt; 0 (up) : 1658, 7.3% ## LFC &lt; 0 (down) : 1366, 6% ## outliers [1] : 58, 0.25% ## low counts [2] : 3976, 17% ## (mean count &lt; 4) ## [1] see &#39;cooksCutoff&#39; argument of ?results ## [2] see &#39;independentFiltering&#39; argument of ?results summary(res_lps, alpha = 0.05) ## ## out of 22783 with nonzero total read count ## adjusted p-value &lt; 0.05 ## LFC &gt; 0 (up) : 2604, 11% ## LFC &lt; 0 (down) : 2650, 12% ## outliers [1] : 58, 0.25% ## low counts [2] : 3534, 16% ## (mean count &lt; 3) ## [1] see &#39;cooksCutoff&#39; argument of ?results ## [2] see &#39;independentFiltering&#39; argument of ?results padj.cutoff &lt;- 0.05 lfc.cutoff &lt;- 0.58 res_pbs_tb &lt;- res_pbs %&gt;% data.frame() %&gt;% rownames_to_column(var=&quot;gene&quot;) %&gt;% as_tibble() res_lps_tb &lt;- res_lps %&gt;% data.frame() %&gt;% rownames_to_column(var=&quot;gene&quot;) %&gt;% as_tibble() head(res_pbs_tb) ## # A tibble: 6 × 7 ## gene baseMean log2FoldChange lfcSE stat pvalue padj ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 ENSMUSG00000051951 2.20 0.300 0.556 0.965 0.334 NA ## 2 ENSMUSG00000103377 1.54 0 0.445 0 1 NA ## 3 ENSMUSG00000103147 3.36 -0.0726 0.665 -0.111 0.911 NA ## 4 ENSMUSG00000102331 2.15 0 0.592 0 1 NA ## 5 ENSMUSG00000102269 3.16 0.752 0.686 1.07 0.286 NA ## 6 ENSMUSG00000098104 66.4 -0.0247 0.328 -0.0757 0.940 0.978 head(res_lps_tb) ## # A tibble: 6 × 7 ## gene baseMean log2FoldChange lfcSE stat pvalue padj ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 ENSMUSG00000051951 2.20 -1.18 0.560 -1.92 0.0550 NA ## 2 ENSMUSG00000103377 1.54 -0.362 0.448 -0.487 0.626 NA ## 3 ENSMUSG00000103147 3.36 0.632 0.667 0.939 0.348 0.561 ## 4 ENSMUSG00000102331 2.15 -0.206 0.605 -0.220 0.826 NA ## 5 ENSMUSG00000102269 3.16 0.729 0.686 1.10 0.271 0.478 ## 6 ENSMUSG00000098104 66.4 0.408 0.327 1.25 0.213 0.407 sig_pbs &lt;- res_pbs_tb %&gt;%dplyr::filter(padj &lt; padj.cutoff &amp; abs(log2FoldChange) &gt;= lfc.cutoff) sig_lps &lt;- res_lps_tb %&gt;% dplyr::filter(padj &lt; padj.cutoff &amp; abs(log2FoldChange) &gt;= lfc.cutoff) nrow(sig_pbs) ## [1] 2039 nrow(sig_lps) ## [1] 4045 "],["gene-annotation.html", "Chapter 5 Gene annotation", " Chapter 5 Gene annotation library(org.Mm.eg.db) mm &lt;- org.Mm.eg.db my.symbols &lt;- res_pbs_tb$gene map &lt;- select(mm, keys = my.symbols, columns = c(&quot;ENTREZID&quot;, &quot;SYMBOL&quot;, &quot;ENSEMBL&quot;), keytype = &quot;ENSEMBL&quot;) ## &#39;select()&#39; returned 1:many mapping between keys and columns ad.df &lt;- left_join(res_pbs_tb, map, by = c(&quot;gene&quot; = &quot;ENSEMBL&quot;)) ad.df &lt;- ad.df[!duplicated(ad.df$gene),] "],["visualization.html", "Chapter 6 Visualization 6.1 Volcano plot", " Chapter 6 Visualization 6.1 Volcano plot library(EnhancedVolcano) EnhancedVolcano(ad.df, lab = ad.df$SYMBOL, x = &#39;log2FoldChange&#39;, y = &#39;padj&#39;, title = &#39;KO vs Control, PBS&#39;, subtitle = NULL, pCutoff = 0.05, FCcutoff = 0.58) "],["functional-analysis.html", "Chapter 7 Functional analysis 7.1 Gene Ontology (GO) analysis 7.2 Gene-Set Enrichment Analysis (GSEA) 7.3 Pathway analysis 7.4 mSigDb enrichment analysis", " Chapter 7 Functional analysis 7.1 Gene Ontology (GO) analysis 7.2 Gene-Set Enrichment Analysis (GSEA) 7.3 Pathway analysis 7.4 mSigDb enrichment analysis library(msigdbr) "],["transcriptome-de-novo-assembly.html", "Chapter 8 Transcriptome de novo assembly", " Chapter 8 Transcriptome de novo assembly To be added. "],["lipidomics-data-analysis.html", "Chapter 9 Lipidomics Data Analysis", " Chapter 9 Lipidomics Data Analysis To be added. "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
